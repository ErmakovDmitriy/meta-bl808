#@TYPE: Machine
#@NAME: BoufalloLabs BL808 baremetal machine
#@DESCRIPTION: Machine configuration for running on a Boufallo Labs BL808 D0 CPU

DEFAULTTUNE = "riscv64"

TUNE_FEATURES:tune-riscv32 = "riscv32"
TUNE_ARCH:tune-riscv32 = "riscv32"
TUNE_PKGARCH:tune-riscv32 = "riscv32"
PACKAGE_EXTRA_ARCHS:tune-riscv32 = "riscv32"

require conf/machine/include/riscv/tune-riscv.inc

MACHINE_FEATURES = "ext2 ext3 serial"
MACHINE_FEATURES:remove = " rtc"
PREFERRED_VERSION_openocd-native = "riscv"
PREFERRED_VERSION_openocd = "riscv"
PREFERRED_PROVIDER_virtual/kernel = "linux-bl808"

TCLIBC = "glibc"

SERIAL_CONSOLES = "2000000;ttyS0"

TUNE_CCARGS:append = "-mabi=lp64d"

IMAGE_BOOT_FILES = "Image bl808-sipeed-m1s.dtb bl808-pine64-ox64.dtb"

EXTRA_IMAGEDEPENDS += "opensbi"
RISCV_SBI_PLAT ?= "generic"

IMAGE_BOOT_FILES:append = " fw_jump.bin"

# TCMODEOVERRIDES .= ":tcmode-external-sourcery-rebuild-libc"

# SKIP_RECIPE[glibc] = ""
# PREFERRED_PROVIDER_glibc = "glibc"
# PREFERRED_PROVIDER_virtual/libc = "glibc"
# PREFERRED_PROVIDER_virtual/libintl = "glibc"
# PREFERRED_PROVIDER_virtual/libiconv = "glibc"
#EXTERNAL_TOOLCHAIN ?= "${TOPDIR}/../tmp/Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.1/"
#EXTERNAL_TOOLCHAIN ?= "${TOPDIR}/../tmp/riscv-toolchain/"
#SYSROOT_PREFIX = ""
#GLIBC_GIT_URI = "git://git@gitee.com/t-head-linux/glibc.git;protocol=https"
#GLIBC_GIT_URI = "git://github.com/T-head-Semi/glibc.git;branch=riscv-glibc-2.33-thead;protocol=https"
#BINUTILS_GIT_URI = "git://github.com/T-head-Semi/binutils-gdb.git;branch=xuantie-binutils-gdb-2.35;protocol=https"
#BINUTILS_GIT_URI ?= "git://git@gitee.com/t-head-linux/binutils-gdb.git;branch=binutils-2_35-branch;protocol=https"
#GCC_GIT_URI = "git://github.com/T-head-Semi/gcc.git;branch=xuantie-gcc-10.2.0;protocol=https"
#TCMODE="external"
#TARGET_PREFIX="riscv64-linux-"
#TARGET_ARCH="riscv64"
#TARGET_OS="linux"
#QEMU_TOOLCHAIN_PATH="${TOPDIR}/../../riscv-toolchain/csky-qemu/bin/"
#SYSROOT_PREFIX ??= "riscv64-buildroot-linux-gnu"
#EXTERNAL_TOOLCHAIN_SYSROOT="${EXTERNAL_TOOLCHAIN}/${SYSROOT_PREFIX}/sysroot/"
